 <%# other_user = nil + only_my_plants false -> search result of other users;
     other_user = set -> show plants created by another user;
     other_user = nil + only_my_plants = true -> show my plants only; %>
<tr>
  <td>
    <% if plant.main_image.file? %>
      <%= link_to image_tag(download_main_image_plant_path(plant, {size: :thumb}), class: "img-rounded img-responsive"), plant %><% end %></td>
  <td><%= link_to plant.name, plant, class: "plant-name" %></td>

  <td>
    <%# if other_user.blank? %>
    <%# TODO: create a helper for this? %>
    <% if only_my_plants %>
      <% if plant.creator != plant.original.user %>
        <small>kopiert von</small><br>
        <%= link_to plant.original.user.display_name, plant.original.user %>
      <% end %>

      <% if plant.creator != current_user %>
        <small>erstellt von</small><br>
        <%= link_to plant.creator.display_name, plant.creator %><br>
      <% end %>

    <% elsif other_user.blank? %><%# means: search result %>
      <small>von</small><br>
      <%= link_to plant.user.display_name, plant.user %><br>
      <% if plant.creator != plant.user %>
        <small>erstellt von</small><br>
        <%= link_to plant.creator.display_name, plant.creator %><br>
      <% end %>

    <% else %> <%# other user's plants %>
      <% if plant.original.user != other_user %>
        <small>kopiert von</small>
        <%= link_to plant.original.user.display_name, plant.original.user %>
      <% end %>

      <% if plant.creator != other_user %>
        <small>erstellt von</small>
        <%= link_to plant.creator.display_name, plant.creator %><br>
      <% end %>
    <% end %>
  </td>

  <% if only_my_plants %>
    <td>
      <div class="plant-visibility"
         data-plant-id="<%= plant.id %>"
         data-switch-allowed="<% if plant.user == current_user %>1<% else %>0<% end %>"
         >
         <%# TODO: data-switch-allowed can be removed? %>

        <% if plant.public %>
          <%= image_tag "world-globe32x32.png" %>
        <% else %>
          <%= image_tag "not-world-globe32x32.png" %>
        <% end %>
      </div>
      <%# if plant.creator == current_user
        </div>
      end %>
    </td>

    <td class="active-button" data-id="<%= plant.id %>" data-path="plants/">
      <% if plant.active %>
      <%# TODO: class: "img-rounded img-responsive" %>
        <%= image_tag "plant_active.gif", height: '42px', width: '30px',  "data-toggle" => "tooltip", "data-placement" => "bottom",
             title: "Pflanze ist aktiv, d.h. Pflegetipps werden in der Aufgabenliste angezeigt. Zum inaktiv schalten, bitte auf das Bild klicken."  %>
      <% else %>
        <%= image_tag "plant_inactive.gif", height: '42px', width: '30px',  "data-toggle" => "tooltip", "data-placement" => "bottom",
             title: "Pflanze ist inaktiv, d.h. Pflegetipps werden in der Aufgabenliste nicht angezeigt. Zum aktiv schalten, bitte auf das Bild klicken."  %>
      <% end %>
    </td>
  <% end %>

  <td>
    <% if plant.public %>
      <div class="likes-counter" data-id=<%= plant.id %> data-path="/plants/" data-likeallowed="<% if plant.user == current_user %>0<% else %>1<% end %>">
        <span class="likes-count"><%= plant.get_likes.size %></span>

        <% if current_user.voted_for?(plant) %>
          <% image_file = "thumb_up_voted.png" %>
        <% else %>
          <% image_file = "thumb_up_not_voted.png" %>
        <% end %>

        <% if plant.user == current_user %>
          <%= image_tag image_file,
              "data-toggle"  => "popover",
              "data-content" => "Du kannst nur Pflanzen anderer Gartenfreunde bewerten.",
              "data-trigger" => "focus",
              "role"         => "button",
              "tabindex"     => "0" %>
        <% else %>
          <%= image_tag image_file %>
        <% end %>
      </div>
    <% end %>
  </td>

  <% if only_my_plants %>
    <td>
      <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
      <%= link_to 'Entfernen', plant, method: :delete, data: { confirm: 'Sind Sie sicher?' }, class: "delete-link" %>
    </td>
  <% end %>
</tr>
