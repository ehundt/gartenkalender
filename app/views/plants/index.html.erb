<% content_for :sidebar do %>
  <%= form_tag(plants_path, method: "get") do %>
    <div class="row sidebar-contacts">
      <div class="col-xs-12">
        <h4>Suche</h4>
        <p><strong>in meiner Pflanzenliste</strong><p>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <div class="input-group">
          <%= text_field_tag(:search, "", class: "form-control", placeholder: "z.B. MÃ¶hre")  %>
          <span class="input-group-btn">
            <%= submit_tag("suchen", class: "btn btn-default") %>
          </span>
        </div><!-- /input-group -->
      </div><!-- /.col-xs-12 -->
    </div><!-- /.row -->
  <% end %>
<% end %>

<% if @other_user %>
  <h4><%= @other_user.display_name %>'s Pflanzen</h4>
<% else %>
  <h4>Meine Pflanzen</h4>
<% end %>

<% if @search_text %>
  <% if @searched_plants.empty? %>
    <p><h5>Suchergebnis: </h5>Keine "<strong><%= @search_text %></strong>" gefunden.</p>
  <% else %>
    <% @plants = @searched_plants %>
  <% end %>

<% elsif @plants.empty? %>
    <p>Eigene Pflanzen werden hier aufgelistet, sobald Du entweder
       selbst welche erstellt hast oder Dir von Freunden welche kopiert hast.
    </p>
<% end %>

<% unless @plants.empty? %>
  <br />
  <table class="table">
  <% @plants.each do |plant| %>
    <tr>
      <td>
        <% if plant.main_image.file? %>
          <%= link_to image_tag(download_main_image_plant_path(plant, {size: :thumb}), class: "img-rounded img-responsive"), plant %><% end %></td>
      <td><%= link_to plant.name, plant %></td>
      <td>
        <% if plant.creator != current_user %>
          von <%= plant.creator.display_name %>
        <% end %>
      </td>
      <% unless @other_user %>
        <td class="active-button" data-id="<%= plant.id %>" data-path="plants/">
          <% if plant.active %>
          <%# TODO: class: "img-rounded img-responsive" %>
            <%= image_tag "plant_active.gif", height: '42px', width: '30px' %>
          <% else %>
            <%= image_tag "plant_inactive.gif", height: '42px', width: '30px' %>
          <% end %>
        </td>
      <% end %>
      <td>
        <% if current_user == plant.creator && plant.original.public %>
          <strong><%= plant.original.get_likes.size %></strong>
          <%= image_tag("green_flower_icon.png", height: '20px', width: '20px') %>
        <% end %>
      </td>
      <% unless @other_user %>
        <td>
          <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
          <%= link_to 'Entfernen', plant, method: :delete, data: { confirm: 'Sind Sie sicher?' }, class: "delete-link" %>
        </td>
      <% end %>
    </tr>
  <% end %>
  </table>
<% end %>
