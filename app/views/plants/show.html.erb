<% content_for :sidebar do %>
  <% if current_user && @plant %>
    <div class="row sidebar-plant">
      <div class="col-xs-12">
        <%= link_to image_tag(@plant.main_image, style: :medium, class: "sidebar-image img-rounded img-responsive"), @plant  %>
      </div>
    </div>
    <div class="row sidebar-plant">
      <div class="col-xs-12">
        <% if @plant.active %>
          <%= image_tag "plant_active.gif", height: '42px', width: '30px' %> aktiv
        <% else %>
          <%= image_tag "plant_inactive.gif", height: '42px', width: '30px' %> nicht aktiv
        <% end %>
      </div>
      <div class="col-xs-12">
        von <%= @plant.creator.display_name %>
      </div>
    </div>
  <% end %>
<% end %>

<div class="row">
  <div class="col-xs-3">
    <h4><%= @plant.name %></h4>
  </div>
  <div class="col-xs-2 active-status">
  </div>
  <div class="col-xs-7 edit-plant-link">
    <% if can? :update, @plant %>
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
      <%= link_to 'Pflanze bearbeiten', edit_plant_path(@plant) %>
    <% end %>
  </div>
</div>
<p>
  <h4><%= @plant.subtitle %></h4>
</p>
<p>
  <%= raw markdown.render(@plant.desc) %>
</p>

<br />
<h4>Aufgaben</h4>
<table class="table">
  <tr>
    <th>Anzeigen</th>
    <th>Titel</th>
    <th>Status</th>
    <th></th>
  </tr>
  <%= render @plant.tasks %>
</table>

<div class="row">
  <div class="col-xs-12">
    <div class="pull-right">
      <% if can? :update, @plant %>
      <%= link_to "Neue Aufgabe", new_plant_task_path(@plant), class: "btn btn-success" %>
      <% end %>
    </div>
  </div>
</div>
<br>
<br>

<% if @plant.user == current_user %>
<h4>Erledigte Aufgaben</h4>
<table class="table">
  <tr>
    <th>Aufgabe</th>
    <th>erledigt am</th>
  </tr>
  <% @plant.tasks.order(updated_at: :desc).each do |task| %>
    <%= render task.done_task %>
  <% end %>
</table>
<% end %>
